import { Meta } from '@storybook/blocks';
import { DesignTokenDocBlock } from 'storybook-design-token';

<Meta title="Ofte stilte sp칮rsm친l/Kan jeg bruke komponentene i Angular Forms?" />

## Kan jeg bruke komponentene i Angular Forms?

<div style={{padding: ".25rem 1rem", background: "#D3E3F5", borderRadius: "2px", borderBottom: "4px solid #3283CE", marginBottom: "1rem"}}>
Om du bruker Angular uten Angular Forms, f.eks. om du bruker komponentene med Javascript/HTML sin standard `formControl` eller utenfor et `form`, kan du bruke dem uten ekstra konfigurasjon.
</div>

Ja du kan bruke FHI Designsystem sine form-komponenter i Angular Forms! 游

Angular Forms er litt annerledes enn standard HTML Forms, og krever at du bruker Angular sine `ControlValueAccessor` for 친 koble komponentene til Angular Forms.

Det finnes 2 m친ter 친 gj칮re dette p친:

### Valg 1: **Bruk `ngDefaultControl`-direktivet**
Dette er den enkleste m친ten 친 koble en komponent til Angular.

For webkomponenter med oppf칮rsel p친 linje med `<input type="text">`, slik som `<fhi-text-input>`, kan du bruke Angular sitt `ngDefaultControl` direktiv for 친 koble komponentene til Angular Forms.

Dette fungerer bra for komponenter som oppf칮rer seg som et standard tekstfelt, og er en enkel m친te 친 f친 komponentene til 친 fungere med Angular Forms.
For andre komponenter som ikke er tekstbaserte, som `<fhi-radio>` og `<fhi-checkbox>`, anbefales det 친 bruke `ControlValueAccessor`-direktiver som beskrevet i valg 2.

#### Eksempel:
```html
<fhi-text-input ngDefaultControl name="myInput" [(ngModel)]="myModel" />
```

### Valg 2: **Gjenbruk Angular sine `ControlValueAccessor`-klasser som direktiver**:
Dette er den anbefalte m친ten 친 bruke FHI Designsystem sine form-komponenter i Angular Forms, spesielt for komponenter som ikke er tekstbaserte eller har funksjonalitet utover et standard tekstfelt, som `<fhi-radio>` og `<fhi-checkbox>`.

Kopier disse direktivene inn i prosjektet ditt:
```typescript
@Directive({ selector: 'fhi-radio[formControlName],fhi-radio[formControl],fhi-radio[ngModel]', standalone: true, providers: [{ provide: NG_VALUE_ACCESSOR, useExisting: forwardRef(() => FHIRadioValueAccessor), multi: true }] })
export class FHIRadioValueAccessor extends RadioControlValueAccessor {}

@Directive({ selector: 'fhi-checkbox[formControlName],fhi-checkbox[formControl],fhi-checkbox[ngModel]', standalone: true, providers: [{ provide: NG_VALUE_ACCESSOR, useExisting: forwardRef(() => FHICheckboxValueAccessor), multi: true }] })
export class FHICheckboxValueAccessor extends CheckboxControlValueAccessor {}

@Directive({ selector: 'fhi-text-input[formControlName],fhi-text-input[formControl],fhi-text-input[ngModel]', standalone: true, providers: [{ provide: NG_VALUE_ACCESSOR, useExisting: forwardRef(() => FHITextInputValueAccessor), multi: true }] })
export class FHITextInputValueAccessor extends DefaultValueAccessor {}
```

Om du n친 importerer disse direktivene i Angular-komponenten din, kan du bruke alle av FHI Designsystem sine `form`-komponenter i Angular Forms uten ekstra arbeid.

#### Eksempel:
```html
<form [formGroup]="myForm">
  <fhi-text-input formControlName="myTextInput" label="Tekstfelt"></fhi-text-input>
  <fhi-radio formControlName="myRadio" value="option1" label="Alternativ 1"></fhi-radio>
  <fhi-radio formControlName="myRadio" value="option2" label="Alternativ 2"></fhi-radio>
  <fhi-checkbox formControlName="myCheckbox" label="Avkrysningsboks"></fhi-checkbox>
</form>
```

```typescript
@Component({
  selector: 'app-root',
  standalone: true,
  imports: [
    FHITextInputValueAccessor, // <-- For bruk av fhi-text-input
    FHICheckboxValueAccessor, // <-- For bruk av fhi-checkbox
    FHIRadioValueAccessor, // <-- For bruk av fhi-radio
    ...,
  ],
  schemas: [CUSTOM_ELEMENTS_SCHEMA],
  templateUrl: './app.component.html',
  styleUrl: './app.component.scss',
})
export class AppComponent {

  myForm = new FormGroup({
      myTextInput: new FormControl(''),
      myRadio: new FormControl(''),
      myCheckbox: new FormControl(false),
  });

  constructor() {}
}
```

**Referanser:**
- [DefaultValueAccessor](https://angular.dev/api/forms/DefaultValueAccessor#usage-notes)
- [Using Web Components in Angular Forms with Element Internals](https://coryrylan.com/blog/using-web-components-in-angular-forms-with-element-internals)
- [Angular - Issue 45953](https://github.com/angular/angular/pull/45953)
- [Missing value accessor](https://angular.dev/errors/NG01203)
